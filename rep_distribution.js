//NOTE: change this if you want to init transactions from a different account
primaryAddress = eth.accounts[0];

var addresses = ["0x7454688c5941897917a852d6887ea79158a107d6", "0x7454688c5941897917a852d6887ea79158a107d6", "0xb01c1ec86fe3668d6b22fb1bde30482f75529aef", "0x107c98584d4b18bc54e1d74f4d7a0bf505ca466f", "0xb19411a9361b22c7d7fe2684639bbbfaa48baae4", "0xa3bff1dfa9971668360c0d82828432e27bf54e67", "0xdc599358ea9d78fbe211b1a96eef766b93571833", "0x6d50D393Eeb679635D729bc6A64B9C71577c572e", "0xfd1cdf4338eeedd9890443d9402808c9cd04f329", "0xE363550833477d7706Aad53Da67366ab1a70C3cD", "0xED962035fA4C80a018915404557E5E05680cafb5", "0xbd3f4d0a53e1957e72bef1bc99e6e552e803456c", "0xf218d6d5fe50ef0dfccc64219f5f9fb9be7a72bc", "0xf19aad8330794943f4857ec87f4c0f79d3169033", "0xa2e63263a50641b5608c4866a99b89b696d76885", "0xf3731A397D198a526EF77bD99906873936f05AB8", "0x550EC205227D3026BEB3b9B05f5da7917EB763d2", "0x10de0b9297f03de2e8975809cb378fae97024824", "0x642f362d9714d521d11faef7428c6e882e91833b", "0xa1a99159d82e3f0f5322c3ff5b7dbd9119dff0b1"];
var balances = [316.1399117351375, 316.13991173513375, 406.86291583324993, 3459.157456885799, 406.86291583324993, 170.80812794359545, 406.86291583324993, 742.9670636955, 2034.31457916625, 310.0295418649365, 101.71572895831248, 159.24289035380738, 2034.31457916625, 45.37526462942845, 14959.317383698402, 326.40286108874744, 203.43145791662496, 146.5619285106526, 16.547999271537915, 207.5000870749575];

var repContract = null;

var code = "7f52657075746174696f6e0000000000000000000000000000000000000000000074010000000000000000000000000000000000000002557f52455000000000000000000000000000000000000000000000000000000000007401000000000000000000000000000000000000000355601274010000000000000000000000000000000000000004556106cb8061009760003961076256600061049f537c01000000000000000000000000000000000000000000000000000000006000350460003413156100495760006000600060003433611388f11515610048576000565b5b63a9059cbb81141561013857365990590160009052366004823760043560605260243560805250335460a05260805160a05112801561008857806100a1565b7401000000000000000000000000000000000000000054155b9050156100ac576000565b335460805113151580156100c057806100d0565b6060515460805160605154011215155b9050156100db576000565b6080513354033355608051606051540160605155601c60405990590160009052016080518152606051337f66e05b8a99642b6a77335be485dc593f0217aee37e6180f32909449b16ed7eca602084a3506001610120526020610120f35b6323b872dd8114156102c05736599059016000905236600482376004356101405260243560605260443560805250610140515460a05260805160a05112801561018157806101aa565b606060605990590160009052600181526101405181602001523381604001528090502054608051135b905080156101b857806101d1565b7401000000000000000000000000000000000000000054155b9050156101dc576000565b610140515460805113151580156101f35780610203565b6060515460805160605154011215155b90501561020e576000565b608051606060605990590160009052600181526101405181602001523381604001528090502054036060606059905901600090526001815261014051816020015233816040015280905020556080516101405154036101405155608051606051540160605155601c60405990590160009052016080518152606051610140517f66e05b8a99642b6a77335be485dc593f0217aee37e6180f32909449b16ed7eca602084a3506001610220526020610220f35b63095ea7b381141561035c57365990590160009052366004823760043561024052602435610260525061026051606060605990590160009052600181523381602001526102405181604001528090502055601c604059905901600090520161026051815261024051337fe64e66bf3e94c88742c041103133494023640d143db88ec4aec44744744d85f1602084a35060016102a05260206102a0f35b63d39d084781141561055657365990590160009052366004823760043560208201016102c05260243560208201016102e0525060006103005260206102c05103516103205260206102e0510351610320511415156103b8576000565b7401000000000000000000000000000000000000000054156103d8576000565b5b610320516103005112156104d957610300516020026102c05101515415156104185774010000000000000000000000000000000000000000541561041b565b60005b156104c957610300516020026102e0510151610300516020026102c051015155610300516020026102e05101517401000000000000000000000000000000000000000154017401000000000000000000000000000000000000000155601c6040599059016000905201610300516020026102e05101518152610300516020026102c051015160007f66e05b8a99642b6a77335be485dc593f0217aee37e6180f32909449b16ed7eca602084a3505b60016103005101610300526103d9565b6a09195731e2ce35eb0000007401000000000000000000000000000000000000000154141561051c57600174010000000000000000000000000000000000000000555b6a09195731e2ce35eb00000074010000000000000000000000000000000000000001541315610549576000565b6001610340526020610340f35b63dd62ed3e8114156105b1573659905901600090523660048237600435610360526024356102405250606060605990590160009052600181526103605181602001526102405181604001528090502054610380526020610380f35b6318160ddd8114156105df5774010000000000000000000000000000000000000001546103c05260206103c0f35b6370a082318114156106115736599059016000905236600482376004356103e052506103e05154610400526020610400f35b6317d7de7c81141561063f577401000000000000000000000000000000000000000254610420526020610420f35b63f0141d8481141561066d577401000000000000000000000000000000000000000454610440526020610440f35b631507040181141561069b577401000000000000000000000000000000000000000354610460526020610460f35b63e44b11a28114156106c9577401000000000000000000000000000000000000000054610480526020610480f35b505b6000f3";

var contract = web3.eth.contract([{
    "name": "allowance",
    "type": "function",
    "constant": false,
    "inputs": [{ "name": "owner", "type": "address" }, { "name": "spender", "type": "address" }],
    "outputs": [{ "name": "out", "type": "int256" }]
},
{
    "name": "approve",
    "type": "function",
    "constant": false,
    "inputs": [{ "name": "spender", "type": "address" }, { "name": "amount", "type": "uint256" }],
    "outputs": [{ "name": "out", "type": "int256" }]
},
{
    "name": "balanceOf",
    "type": "function",
    "constant": false,
    "inputs": [{ "name": "address", "type": "address" }],
    "outputs": [{ "name": "out", "type": "int256" }]
},
{
    "name": "getDecimals",
    "type": "function",
    "constant": false,
    "inputs": [],
    "outputs": [{ "name": "out", "type": "int256" }]
},
{
    "name": "getName",
    "type": "function",
    "constant": false,
    "inputs": [],
    "outputs": [{ "name": "out", "type": "int256" }]
},
{
    "name": "getSeeded",
    "type": "function",
    "constant": false,
    "inputs": [],
    "outputs": [{ "name": "out", "type": "int256" }]
},
{
    "name": "getSymbol",
    "type": "function",
    "constant": false,
    "inputs": [],
    "outputs": [{ "name": "out", "type": "int256" }]
},
{
    "name": "setSaleDistribution",
    "type": "function",
    "constant": false,
    "inputs": [{ "name": "addresses", "type": "address[]" }, { "name": "balances", "type": "uint256[]" }],
    "outputs": [{ "name": "out", "type": "int256" }]
},
{
    "name": "totalSupply",
    "type": "function",
    "constant": false,
    "inputs": [],
    "outputs": [{ "name": "out", "type": "int256" }]
},
{
    "name": "transfer",
    "type": "function",
    "constant": false,
    "inputs": [{ "name": "receiver", "type": "address" }, { "name": "fxpValue", "type": "uint256" }],
    "outputs": [{ "name": "out", "type": "int256" }]
},
{
    "name": "transferFrom",
    "type": "function",
    "constant": false,
    "inputs": [{ "name": "from", "type": "address" }, { "name": "receiver", "type": "address" }, { "name": "fxpValue", "type": "uint256" }],
    "outputs": [{ "name": "out", "type": "int256" }]
},
{
    "name": "Approval",
    "type": "event",
    "inputs": [{ "name": "owner", "type": "int256", "indexed": true }, { "name": "spender", "type": "int256", "indexed": true }, { "name": "fxpValue", "type": "int256", "indexed": false }]
},
{
    "name": "Transfer",
    "type": "event",
    "inputs": [{ "name": "from", "type": "int256", "indexed": true }, { "name": "to", "type": "int256", "indexed": true }, { "name": "fxpValue", "type": "int256", "indexed": false }]
}]);

var loadRepContract = function(){

	contract.new({from: primaryAddress, data: code, gas: 2000000}, function(error, result){
  		if (error){
  			console.log(error);
  		}
  		if (result.address){
  			console.log("REP ontract address: ", result.address);
  			repContract = result;
  		}
	});
}

var batchSize = 3;
var fxp = Math.pow(10, 18);

var initializeRepBalances = function(start){

	if (addresses.length != balances.length){
		console.log("WARNING: addresses/balances array mismatch");
	}

	if (start >= addresses.length){
		console.log("done");
		return;
	}
	
	console.log("loading addresses", start, "through", Math.min(start + batchSize -1, addresses.length) , "/", addresses.length);

	var addrBatch = addresses.slice(start, start + batchSize);
	//convert balances to 10^18 fixed point
	var balanceBatch = balances.slice(start, start + batchSize).map( function(n) {return n * fxp});

	repContract.setSaleDistribution(addrBatch, balanceBatch, {from: primaryAddress, gas: 2000000},
		function (error, obj) {
		    if (error) {
		        console.log("error", error);
		    } else {
		    	return initializeBalances(start + batchSize);
		    }
		}
	);
}


